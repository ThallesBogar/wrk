#lang racket

(require rackunit)
(require math/array)
(require racket/class)


(define (p-nand a b)
  (cond
    [(and (= a 1) (= b 1)) 0]
    [else 1]))

(define (p-not a)
  (p-nand a a))

(define (p-and a b)
  (p-not (p-nand a b)))

(define (p-or a b)
  (p-nand (p-not a) (p-not b)))

(define (p-xor a b)
  (let ( (c (p-nand a b)))
    (p-nand (p-nand a c)
            (p-nand c b))))

(define (p-xnor a b)
  (p-not (p-xor a b)))

(define (p-nor a b)
  (p-not (p-or a b)))

(define (p-mux in1 in2 sel)
  (p-or (p-and (p-not sel) in1) (p-and sel in2)))

(define (p-demux in sel)
  (list (p-and (p-not sel) in) (p-and sel in)))

(define (p-or8way a b c d e f g h)
  (p-or (p-or (p-or a b) (p-or c d)) (p-or (p-or e f) (p-or g h))))

(define (p-mux4way in1 in2 in3 in4 sel1 sel2)
  (p-or (p-or (p-and (p-and (p-not sel1) (p-not sel2)) in1) (p-and (p-and (p-not sel1) sel2) in2))
	(p-or (p-and (p-and sel1 (p-not sel2)) in3) (p-and (p-and sel1 sel2) in4))))

(define (p-demux4way in sel1 sel2)
  (list (p-and (p-and (p-not sel1) (p-not sel2)) in)
	(p-and (p-and (p-not sel1) sel2) in)
	(p-and (p-and sel1 (p-not sel2)) in)
	(p-and (p-and sel1 sel2) in)))

(define (p-demux8way in sel1 sel2 sel3)
  (list (p-and (p-and (p-and (p-not sel1) (p-not sel2)) (p-not sel3)) in)
	(p-and (p-and (p-and (p-not sel1) (p-not sel2)) sel3) in)
	(p-and (p-and (p-and (p-not sel1) sel2) (p-not sel3)) in)
	(p-and (p-and (p-and (p-not sel1) sel2) sel3) in)
	(p-and (p-and (p-and sel1 (p-not sel2)) (p-not sel3)) in)
	(p-and (p-and (p-and sel1 (p-not sel2)) sel3) in)
	(p-and (p-and (p-and sel1 sel2) (p-not sel3)) in)
	(p-and (p-and (p-and sel1 sel2) sel3) in)))

(define (p-mux8way16 in1 in2 in3 in4 in5 in6 in7 in8 sel3 sel2 sel1)
  (p-mux16 (p-mux4way16 in1 in2 in3 in4 sel2 sel1) (p-mux4way16 in5 in6 in7 in8 sel2 sel1) sel3))

(define (p-not16 a)
  (for/list ( (i '(0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15)))
    (p-not (list-ref a i))))

(define (p-and16 a b)
  (for/list ( (i '(0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15)))
    (p-and (list-ref a i) (list-ref b i))))

(define (p-or16 a b)
  (for/list ( (i '(0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15)))
    (p-or (list-ref a i) (list-ref b i))))

(define (p-mux16 in1 in2 sel)
  (for/list ( (i '(0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15)))
    (p-mux (list-ref in1 i) (list-ref in2 i) sel)))
  
(define (p-mux4way16 in1 in2 in3 in4 sel1 sel2)
  (for/list ( (i '(0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15)))
    (p-mux4way (list-ref in1 i) (list-ref in2 i) (list-ref in3 i) (list-ref in4 i) sel1 sel2)))

(define (p-halfadder in1 in2)
  (list (p-xor in1 in2) (p-and in1 in2)))

(define (p-fulladder in2 in1 in0)
  (let* ( (p1 (p-halfadder in1 in0))
	  (p2 (p-halfadder in2 (car p1))))
    (list (car p2) (p-or (cadr p2) (cadr p1)))))

(check-equal? (p-nand 0 0) 1)
(check-equal? (p-nand 0 1) 1)
(check-equal? (p-nand 1 0) 1)
(check-equal? (p-nand 1 1) 0)

(check-equal? (p-not 0) 1)
(check-equal? (p-not 1) 0)

(check-equal? (p-xor 0 0) 0)
(check-equal? (p-xor 0 1) 1)
(check-equal? (p-xor 1 0) 1)
(check-equal? (p-xor 1 1) 0)

(check-equal? (p-or 0 0) 0)
(check-equal? (p-or 0 1) 1)
(check-equal? (p-or 1 0) 1)
(check-equal? (p-or 1 1) 1)

(check-equal? (p-mux 0 0 0) 0)
(check-equal? (p-mux 0 0 1) 0)
(check-equal? (p-mux 1 0 0) 1)
(check-equal? (p-mux 1 0 1) 0)
(check-equal? (p-mux 0 1 0) 0)
(check-equal? (p-mux 0 1 1) 1)
(check-equal? (p-mux 1 1 0) 1)
(check-equal? (p-mux 1 1 1) 1)

(check-equal? (p-demux 0 0) '(0 0))
(check-equal? (p-demux 0 1) '(0 0))
(check-equal? (p-demux 1 0) '(1 0))
(check-equal? (p-demux 1 1) '(0 1))

(check-equal? (p-or8way 0 0 0 0 0 0 0 0) 0)
(check-equal? (p-or8way 1 1 1 1 1 1 1 1) 1)
(check-equal? (p-or8way 0 0 0 1 0 0 0 0) 1)
(check-equal? (p-or8way 0 0 0 0 0 0 0 1) 1)
(check-equal? (p-or8way 0 0 1 0 0 1 1 0) 1)

(check-equal? (p-demux4way 0 0 0) '(0 0 0 0))
(check-equal? (p-demux4way 0 0 1) '(0 0 0 0))
(check-equal? (p-demux4way 0 1 0) '(0 0 0 0))
(check-equal? (p-demux4way 0 1 1) '(0 0 0 0))
(check-equal? (p-demux4way 1 0 0) '(1 0 0 0))
(check-equal? (p-demux4way 1 0 1) '(0 1 0 0))
(check-equal? (p-demux4way 1 1 0) '(0 0 1 0))
(check-equal? (p-demux4way 1 1 1) '(0 0 0 1))

(check-equal? (p-demux8way 0 0 0 0) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 0 0 1) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 0 1 0) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 0 1 1) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 1 0 0) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 1 0 1) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 1 1 0) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 0 1 1 1) '(0 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 1 0 0 0) '(1 0 0 0 0 0 0 0))
(check-equal? (p-demux8way 1 0 0 1) '(0 1 0 0 0 0 0 0))
(check-equal? (p-demux8way 1 0 1 0) '(0 0 1 0 0 0 0 0))
(check-equal? (p-demux8way 1 0 1 1) '(0 0 0 1 0 0 0 0))
(check-equal? (p-demux8way 1 1 0 0) '(0 0 0 0 1 0 0 0))
(check-equal? (p-demux8way 1 1 0 1) '(0 0 0 0 0 1 0 0))
(check-equal? (p-demux8way 1 1 1 0) '(0 0 0 0 0 0 1 0))
(check-equal? (p-demux8way 1 1 1 1) '(0 0 0 0 0 0 0 1))

(check-equal? (p-not16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1))
(check-equal? (p-not16 '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-not16 '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0)) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1))
(check-equal? (p-not16 '(0 0 1 1 1 1 0 0 1 1 0 0 0 0 1 1)) '(1 1 0 0 0 0 1 1 0 0 1 1 1 1 0 0))
(check-equal? (p-not16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0)) '(1 1 1 0 1 1 0 1 1 1 0 0 1 0 1 1))

(check-equal? (p-and16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-and16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-and16 '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1))
(check-equal? (p-and16 '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1)) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-and16 '(0 0 1 1 1 1 0 0 1 1 0 0 0 0 1 1) '(0 0 0 0 1 1 1 1 1 1 1 1 0 0 0 0)) '(0 0 0 0 1 1 0 0 1 1 0 0 0 0 0 0))
(check-equal? (p-and16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0)) '(0 0 0 1 0 0 0 0 0 0 1 1 0 1 0 0))

(check-equal? (p-or16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-or16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1))
(check-equal? (p-or16 '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1))
(check-equal? (p-or16 '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1)) '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1))
(check-equal? (p-or16 '(0 0 1 1 1 1 0 0 1 1 0 0 0 0 1 1) '(0 0 0 0 1 1 1 1 1 1 1 1 0 0 0 0)) '(0 0 1 1 1 1 1 1 1 1 1 1 0 0 1 1))
(check-equal? (p-or16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0)) '(1 0 0 1 1 0 1 0 0 1 1 1 0 1 1 0))

(check-equal? (p-mux16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 1) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) 1) '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0))
(check-equal? (p-mux16 '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0))
(check-equal? (p-mux16 '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 1) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux16 '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1) 0) '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0))
(check-equal? (p-mux16 '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1) 1) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1))

(check-equal? (p-mux4way16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux4way16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 0 1) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux4way16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 1 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux4way16 '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0) 1 1) '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux4way16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0) '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1) 0 0) '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0))
(check-equal? (p-mux4way16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0) '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1) 0 1) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0))
(check-equal? (p-mux4way16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0) '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1) 1 0) '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0))
(check-equal? (p-mux4way16 '(0 0 0 1 0 0 1 0 0 0 1 1 0 1 0 0) '(1 0 0 1 1 0 0 0 0 1 1 1 0 1 1 0) '(1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1) 1 1) '(0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1))

(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 0 0 0)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 0 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 1 0 0)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 1 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1))
(check-equal? (p-mux8way16
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1)
               '(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1)
               '(0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 0)
               '(1 1 1 1 1 1 1 1 0 0 0 0 0 0 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0)
                 1 1 1)
               '(1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0))

(check-equal? (p-halfadder 0 0) '(0 0))
(check-equal? (p-halfadder 0 1) '(1 0))
(check-equal? (p-halfadder 1 0) '(1 0))
(check-equal? (p-halfadder 1 1) '(0 1))

(check-equal? (p-fulladder 0 0 0) '(0 0))
(check-equal? (p-fulladder 0 0 1) '(1 0))
(check-equal? (p-fulladder 0 1 0) '(1 0))
(check-equal? (p-fulladder 0 1 1) '(0 1))
(check-equal? (p-fulladder 1 0 0) '(1 0))
(check-equal? (p-fulladder 1 0 1) '(0 1))
(check-equal? (p-fulladder 1 1 0) '(0 1))
(check-equal? (p-fulladder 1 1 1) '(1 1))
